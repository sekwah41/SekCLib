"use strict";(self.webpackChunksekclib_docs=self.webpackChunksekclib_docs||[]).push([[861],{3905:function(e,t,n){n.d(t,{kt:function(){return d}});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},y=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,y=l(e,["components","mdxType","originalType","parentName"]),d=c(n),p=i,b=d["".concat(s,".").concat(p)]||d[p]||u[p]||r;return n?a.createElement(b,o(o({ref:t},y),{},{components:n})):a.createElement(b,o({ref:t},y))}));function d(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=y;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var c=2;c<r;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}y.displayName="MDXCreateElement"},6022:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return s},default:function(){return p},frontMatter:function(){return l},metadata:function(){return c},toc:function(){return y}});var a=n(3117),i=n(102),r=(n(7294),n(3905)),o=["components"],l={sidebar_position:3,description:"Info on the @Sync Annotation and how to use it"},s="@Sync Annotation",c={unversionedId:"sync",id:"sync",title:"@Sync Annotation",description:"Info on the @Sync Annotation and how to use it",source:"@site/docs/sync.md",sourceDirName:".",slug:"/sync",permalink:"/docs/sync",editUrl:"https://github.com/sekwah41/SekCLib/edit/master/docs/docs/sync.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,description:"Info on the @Sync Annotation and how to use it"},sidebar:"tutorialSidebar",previous:{title:"Contributing",permalink:"/docs/contributing"}},u={},y=[{value:"Registering a Capability for Syncing",id:"registering-a-capability-for-syncing",level:2},{value:"@Sync Attributes",id:"sync-attributes",level:2},{value:"int minTicks",id:"int-minticks",level:3},{value:"boolean syncGlobally",id:"boolean-syncglobally",level:3},{value:"Registering Custom @Sync Types",id:"registering-custom-sync-types",level:2},{value:"Registering Example",id:"registering-example",level:3},{value:"Basic Example of SyncTrackerSerializer",id:"basic-example-of-synctrackerserializer",level:3},{value:"SyncTrackerClone",id:"synctrackerclone",level:3},{value:"SyncTrackerUpdater",id:"synctrackerupdater",level:3}],d={toc:y};function p(e){var t=e.components,n=(0,i.Z)(e,o);return(0,r.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"sync-annotation"},"@Sync Annotation"),(0,r.kt)("p",null,"This allows for the automatic syncing of data from the server to the client for entity capabilities."),(0,r.kt)("p",null,"If there is demand we will also be looking into supporting other capability types if requested."),(0,r.kt)("p",null,"The main interfaces will be kept the same though we will be optimising and improving the underlying code.\nThis should not require any changes to your mod code though we will release major version bumps if it does make any incompatible changes.\nWe will also announce on our ",(0,r.kt)("a",{parentName:"p",href:"https://discord.sekwah.com/"},"Discord")," server if there are any major changes."),(0,r.kt)("p",null,"You can make edits on the client side, though whenever the values are broadcasted from the server it will overwrite whatever you  have set locally.\nThis can be used if you can accurately update client side but want to just re-sync it on an interval from the server."),(0,r.kt)("h2",{id:"registering-a-capability-for-syncing"},"Registering a Capability for Syncing"),(0,r.kt)("p",null,"To register a capability for syncing you will need to listen to the ",(0,r.kt)("inlineCode",{parentName:"p"},"RegisterCapabilitySyncEvent")," on the ",(0,r.kt)("inlineCode",{parentName:"p"},"MOD")," event bus."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/sekwah41/Naruto-Mod/blob/2a87ced2daa10cf9eaf3c1f2e480a2ea5ddedd3d/src/main/java/com/sekwah/narutomod/NarutoMod.java#L91-L93"},"Example Code")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Mod.EventBusSubscriber(modid = NarutoMod.MOD_ID, bus = Mod.EventBusSubscriber.Bus.MOD)\npublic class NarutoSyncTrackers {\n    @SubscribeEvent\n    public static void registerCapabilitySync(RegisterCapabilitySyncEvent event) {\n        /*\n         * You do not need to use the same resource location as the capability though it makes it easier to keep track of\n         * Provide the capability reference you would pass to .getCapability and the class that implements it.\n         * This is the one you plan to use the @Sync annotations in.\n         */\n        event.registerPlayerCap(new ResourceLocation(NarutoMod.MOD_ID, "ninja_data"), NinjaCapabilityHandler.NINJA_DATA, NinjaData.class);\n    }\n}\n')),(0,r.kt)("h2",{id:"sync-attributes"},"@Sync Attributes"),(0,r.kt)("p",null,"You can further customise the way that the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/sekwah41/SekCLib/blob/master/src/main/java/com/sekwah/sekclib/capabilitysync/capabilitysync/annotation/Sync.java"},"@Sync")," annotation works by adding attributes to the annotation.\nFor the most part the names should be relatively self-explanatory."),(0,r.kt)("h3",{id:"int-minticks"},"int minTicks"),(0,r.kt)("p",null,"Default: 3"),(0,r.kt)("p",null,"This is the minimum number of ticks between syncs.\nThis is to prevent syncing too often, a good example would be large visual changes which could be abused to cause epilepsy or generally would be visually unpleasant."),(0,r.kt)("h3",{id:"boolean-syncglobally"},"boolean syncGlobally"),(0,r.kt)("p",null,"If the data being synced should be available to all players.\nThis is useful for data needed for visual changes or other info that all players may need to know for your other features.\nIf this is false, the values will never be changes from their default values unless the capability is attached to their player."),(0,r.kt)("p",null,"A good example where you may not want to globally sync is if you are syncing a player's energy/mana.\nThis will avoid third party mods being able to retrieve that data and create extra feedback as well as unnecessary packets to all surrounding players if you are syncing a large object."),(0,r.kt)("p",null,"If the capability you are syncing only ever attached to entities, then you will need this to be set to true otherwise no data will ever be sent to a client. If you do not want this then leave the @Sync annotation off as it won't do anything."),(0,r.kt)("h2",{id:"registering-custom-sync-types"},"Registering Custom @Sync Types"),(0,r.kt)("p",null,"If you want to sync a type we do not currently support please raise a PR on ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/sekwah41/SekCLib"},"Github")," so we can officially support it.\nThough if you plan to sync a custom type you can do so by registering it with the ",(0,r.kt)("inlineCode",{parentName:"p"},"RegisterSyncTrackerTypeEvent")," event.\nYou will also need to make a custom class so that the mod knows how to add and retrieve the data from the ",(0,r.kt)("inlineCode",{parentName:"p"},"FriendlyByteBuf"),"."),(0,r.kt)("h3",{id:"registering-example"},(0,r.kt)("a",{parentName:"h3",href:"https://github.com/sekwah41/Naruto-Mod/blob/2a87ced2daa10cf9eaf3c1f2e480a2ea5ddedd3d/src/main/java/com/sekwah/narutomod/trackers/NarutoSyncTrackers.java"},"Registering Example")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@Mod.EventBusSubscriber(modid = NarutoMod.MOD_ID, bus = Mod.EventBusSubscriber.Bus.MOD)\npublic class NarutoSyncTrackers {\n    @SubscribeEvent\n    public static void registerSyncTrackerEvent(RegisterSyncTrackerTypeEvent event) {\n        event.registerSyncTracker(ToggleAbilityData.class, new ToggleAbilityDataSyncTracker());\n        event.registerSyncTracker(DoubleJumpData.class, new DoubleJumpDataSyncTracker());\n    }\n}\n")),(0,r.kt)("h3",{id:"basic-example-of-synctrackerserializer"},"Basic Example of SyncTrackerSerializer"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public class ResourceLocationSyncTracker implements SyncTrackerSerializer<ResourceLocation> {\n\n    @Override\n    public void encode(ResourceLocation objectToSend, FriendlyByteBuf outBuffer) {\n        outBuffer.writeUtf(objectToSend.toString());\n    }\n\n    @Override\n    public ResourceLocation decode(FriendlyByteBuf inBuffer) {\n        return new ResourceLocation(inBuffer.readUtf());\n    }\n}\n")),(0,r.kt)("h3",{id:"synctrackerclone"},"SyncTrackerClone"),(0,r.kt)("p",null,"This is used to clone the data when copies of the last sent data are being used.\nWithout this the library would not be able to tell if the data has changed as it would be using a reference to compare to the original."),(0,r.kt)("p",null,"Example of a ",(0,r.kt)("inlineCode",{parentName:"p"},"SyncTrackerSerializer")," & ",(0,r.kt)("inlineCode",{parentName:"p"},"SyncTrackerClone")," implementation"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public class ToggleAbilityDataSyncTracker implements SyncTrackerSerializer<ToggleAbilityData>, SyncTrackerClone<ToggleAbilityData> {\n\n    @Override\n    public void encode(ToggleAbilityData objectToSend, FriendlyByteBuf outBuffer) {\n        outBuffer.writeInt(objectToSend.getAbilitiesHashSet().size());\n        for (ResourceLocation ability : objectToSend.getAbilitiesHashSet()) {\n            outBuffer.writeUtf(ability.toString());\n        }\n    }\n\n    @Override\n    public ToggleAbilityData decode(FriendlyByteBuf inBuffer) {\n        final int size = inBuffer.readInt();\n        ToggleAbilityData data = new ToggleAbilityData(size);\n        for(int i = 0; i < size; i++) {\n            data.getAbilitiesHashSet().add(new ResourceLocation(inBuffer.readUtf()));\n        }\n        return data;\n    }\n\n    @Override\n    public ToggleAbilityData clone(ToggleAbilityData data) {\n        ToggleAbilityData cloned = new ToggleAbilityData(data.getAbilitiesHashSet().size());\n        cloned.getAbilitiesHashSet().addAll(data.getAbilitiesHashSet());\n        return cloned;\n    }\n}\n")),(0,r.kt)("h3",{id:"synctrackerupdater"},"SyncTrackerUpdater"),(0,r.kt)("p",null,"For some objects you may not want to replace the object every time to keep references to other objects you have created. While we do not currently have an example though the interface for\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/sekwah41/SekCLib/blob/master/src/main/java/com/sekwah/sekclib/capabilitysync/capabilitysync/tracker/SyncTrackerUpdater.java"},"SyncTrackerUpdater"),"\nshould be pretty self-explanatory."),(0,r.kt)("p",null,"You likely will not need to use this though it is there just in case."))}p.isMDXComponent=!0}}]);